# 2. 技術スタック

各フェーズで使用する技術スタックの詳細を記載します。

## MVP (Phase 1)

### フロントエンド

**技術**: Streamlit

**選定理由**

- シンプルなUI構築が可能
- ストリーミング表示に対応
- Pythonのみで完結
- プロトタイプ開発に最適

**主な機能**

- エージェント選択UI
- チャットインターフェース
- メッセージストリーミング表示

### バックエンド

**技術**: FastAPI

**選定理由**

- 高速な非同期処理
- WebSocket/SSE対応
- 自動APIドキュメント生成
- Pydanticによる型安全性

**主な機能**

- RESTful API
- Server-Sent Events (SSE)
- セッション管理

### LLM SDK

**技術**: OpenAI Agents SDK

**選定理由**

- エージェント実装の基盤
- Function Calling対応
- ストリーミング対応
- MCP統合が容易

### LLMプロバイダ

**技術**: LM Studio (Local)

**選定理由**

- ローカルでの開発・テストが可能
- コスト不要
- OpenAI互換API
- GPU活用

**推奨モデル**

- qwen2.5-coder-7b-instruct (コーディング特化)
- OpenGPT

### MCP

**技術**: MCP Scraping Server

**選定理由**

- 既存MCPサーバー利用
- npmで簡単インストール
- Webスクレイピング機能

**使用サーバー**

- @modelcontextprotocol/server-fetch

### 通信

**技術**: Server-Sent Events (SSE)

**選定理由**

- ストリーミングレスポンスに最適
- HTTP/1.1で動作
- シンプルな実装

### 環境

**技術**: ローカル開発 (Docker Compose推奨)

**構成**

- バックエンドコンテナ
- フロントエンドコンテナ
- LM Studio (ホストマシン)

---

## Phase 2

### フロントエンド

**技術**: React (S3 + CloudFront)

**変更理由**

- リッチなUI実装
- SPAによる高速化
- 本格的なプロダクション環境

**技術スタック**

- React 18+
- TypeScript
- Vite
- Material-UI / shadcn/ui

### バックエンド

**技術**: AWS Lambda + FastAPI

**変更理由**

- サーバーレス化
- 自動スケーリング
- コスト最適化

**技術スタック**

- FastAPI
- Mangum (Lambda adapter)
- API Gateway

### LLMプロバイダ

**技術**: AWS Bedrock

**変更理由**

- マネージドサービス
- 複数モデル対応
- AWS統合

**利用可能モデル**

- Claude 3.5 Sonnet
- Llama 3
- その他Bedrockモデル

### ストレージ

**技術**: AWS S3

**用途**

- ファイルアップロード保存
- 静的コンテンツ配信

### データベース

**技術**: PostgreSQL (RDS)

**選定理由**

- リレーショナルデータに適合
- JSON型でメタデータ保存可能
- AWS RDSで簡単スケール
- DynamoDBより開発速度優先

**用途**

- 会話履歴永続化
- セッション管理

### MCP

**技術**: 複数MCPサーバー

**追加サーバー**

- @modelcontextprotocol/server-filesystem
- @modelcontextprotocol/server-postgres
- カスタムMCP Server

---

## Phase 3以降

### 認証

**技術**: AWS Cognito / Auth0

**機能**

- ユーザー登録・ログイン
- JWT認証
- 権限管理

### API Gateway

**技術**: AWS API Gateway

**機能**

- 認証統合
- レート制限
- APIキー管理

### 複数SDK

**技術**: ADK実装

**配置**: 別リポジトリで並行開発

**機能**

- Anthropic SDK統合
- 既存API仕様への適合
- パフォーマンス比較

---

## 技術スタック比較表

| レイヤー | MVP (Phase 1) | Phase 2 | Phase 3以降 |
| --- | --- | --- | --- |
| フロントエンド | Streamlit | React (S3) | React (S3) |
| バックエンド | FastAPI (Local) | Lambda + FastAPI | Lambda + FastAPI |
| LLM SDK | OpenAI SDK | OpenAI + AWS SDK | OpenAI + AWS + ADK |
| LLM Provider | LM Studio | Bedrock | Bedrock |
| DB | なし (メモリ) | PostgreSQL RDS | PostgreSQL RDS |
| 認証 | なし | なし | Cognito/Auth0 |
| ストレージ | なし | S3 | S3 |
| MCP | server-fetch | 複数サーバー | カスタム含む |